/* See the Tailwind configuration guide for advanced usage
   https://tailwindcss.com/docs/configuration */

@import "tailwindcss" source(none);
@source "../css";
@source "../js";
@source "../../lib/gridroom_web";

/* A Tailwind plugin that makes "hero-#{ICON}" classes available.
   The heroicons installation itself is managed by your mix.exs */
@plugin "../vendor/heroicons";

/* daisyUI Tailwind Plugin. You can update this file by fetching the latest version with:
   curl -sLO https://github.com/saadeghi/daisyui/releases/latest/download/daisyui.js
   Make sure to look at the daisyUI changelog: https://daisyui.com/docs/changelog/ */
@plugin "../vendor/daisyui" {
  themes: false;
}

/* daisyUI theme plugin. You can update this file by fetching the latest version with:
  curl -sLO https://github.com/saadeghi/daisyui/releases/latest/download/daisyui-theme.js
  We ship with two themes, a light one inspired on Phoenix colors and a dark one inspired
  on Elixir colors. Build your own at: https://daisyui.com/theme-generator/ */
@plugin "../vendor/daisyui-theme" {
  name: "dark";
  default: false;
  prefersdark: true;
  color-scheme: "dark";
  --color-base-100: oklch(30.33% 0.016 252.42);
  --color-base-200: oklch(25.26% 0.014 253.1);
  --color-base-300: oklch(20.15% 0.012 254.09);
  --color-base-content: oklch(97.807% 0.029 256.847);
  --color-primary: oklch(58% 0.233 277.117);
  --color-primary-content: oklch(96% 0.018 272.314);
  --color-secondary: oklch(58% 0.233 277.117);
  --color-secondary-content: oklch(96% 0.018 272.314);
  --color-accent: oklch(60% 0.25 292.717);
  --color-accent-content: oklch(96% 0.016 293.756);
  --color-neutral: oklch(37% 0.044 257.287);
  --color-neutral-content: oklch(98% 0.003 247.858);
  --color-info: oklch(58% 0.158 241.966);
  --color-info-content: oklch(97% 0.013 236.62);
  --color-success: oklch(60% 0.118 184.704);
  --color-success-content: oklch(98% 0.014 180.72);
  --color-warning: oklch(66% 0.179 58.318);
  --color-warning-content: oklch(98% 0.022 95.277);
  --color-error: oklch(58% 0.253 17.585);
  --color-error-content: oklch(96% 0.015 12.422);
  --radius-selector: 0.25rem;
  --radius-field: 0.25rem;
  --radius-box: 0.5rem;
  --size-selector: 0.21875rem;
  --size-field: 0.21875rem;
  --border: 1.5px;
  --depth: 1;
  --noise: 0;
}

@plugin "../vendor/daisyui-theme" {
  name: "light";
  default: true;
  prefersdark: false;
  color-scheme: "light";
  --color-base-100: oklch(98% 0 0);
  --color-base-200: oklch(96% 0.001 286.375);
  --color-base-300: oklch(92% 0.004 286.32);
  --color-base-content: oklch(21% 0.006 285.885);
  --color-primary: oklch(70% 0.213 47.604);
  --color-primary-content: oklch(98% 0.016 73.684);
  --color-secondary: oklch(55% 0.027 264.364);
  --color-secondary-content: oklch(98% 0.002 247.839);
  --color-accent: oklch(0% 0 0);
  --color-accent-content: oklch(100% 0 0);
  --color-neutral: oklch(44% 0.017 285.786);
  --color-neutral-content: oklch(98% 0 0);
  --color-info: oklch(62% 0.214 259.815);
  --color-info-content: oklch(97% 0.014 254.604);
  --color-success: oklch(70% 0.14 182.503);
  --color-success-content: oklch(98% 0.014 180.72);
  --color-warning: oklch(66% 0.179 58.318);
  --color-warning-content: oklch(98% 0.022 95.277);
  --color-error: oklch(65% 0.241 354.308);
  --color-error-content: oklch(97% 0.014 343.198);
  --radius-selector: 0.25rem;
  --radius-field: 0.25rem;
  --radius-box: 0.5rem;
  --size-selector: 0.21875rem;
  --size-field: 0.21875rem;
  --border: 1.5px;
  --depth: 1;
  --noise: 0;
}

/* Add variants based on LiveView classes */
@custom-variant phx-click-loading ([".phx-click-loading&", ".phx-click-loading &"]);
@custom-variant phx-submit-loading ([".phx-submit-loading&", ".phx-submit-loading &"]);
@custom-variant phx-change-loading ([".phx-change-loading&", ".phx-change-loading &"]);

/* Make LiveView wrapper divs transparent for layout */
[data-phx-root-id] { display: contents }

/* This file is for your main application CSS */

/* ============================================
   GRIDROOM - The Liminal Space
   A place between places. Severance meets hearth.
   ============================================ */

@import url('https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@300;400;500&family=JetBrains+Mono:wght@300;400&family=Space+Grotesk:wght@300;400;500&display=swap');

:root {
  /* Deep foundation - like stone walls at night */
  --void: #0d0b0a;
  --abyss: #141210;
  --stone: #1c1917;
  --earth: #231f1c;
  --bark: #2a2522;

  /* Atmospheric layers */
  --mist: rgba(232, 224, 213, 0.03);
  --fog: rgba(232, 224, 213, 0.06);
  --haze: rgba(232, 224, 213, 0.12);

  /* Grid structure - barely visible, like old maps */
  --grid-faint: rgba(139, 115, 85, 0.04);
  --grid-subtle: rgba(139, 115, 85, 0.08);
  --grid-visible: rgba(139, 115, 85, 0.15);

  /* Text hierarchy - parchment tones */
  --text-bright: #f5f0e8;
  --text-primary: #e8e0d5;
  --text-secondary: #c4b8a8;
  --text-tertiary: #8a7d6d;
  --text-ghost: #5a4f42;

  /* Warm ember palette - candlelit tavern */
  --ember-bright: #f4c896;
  --ember: #dba76f;
  --ember-deep: #c4915a;
  --amber: #b8860b;
  --rust: #8b4513;

  /* Cool counterpoint - moonlight through window */
  --silver: #a8b2bc;
  --steel: #6b7a8a;
  --slate: #4a5568;

  /* Node type colors */
  --node-discussion: #c9a962;
  --node-question: #7eb8da;
  --node-debate: #d4756a;
  --node-quiet: #8b9a7d;

  /* Glows and effects */
  --glow-warm: rgba(219, 167, 111, 0.4);
  --glow-soft: rgba(219, 167, 111, 0.15);
  --glow-faint: rgba(219, 167, 111, 0.08);

  /* Timing */
  --ease-out-expo: cubic-bezier(0.19, 1, 0.22, 1);
  --ease-in-out-sine: cubic-bezier(0.37, 0, 0.63, 1);
}

/* ============================================
   Typography
   ============================================ */

body {
  font-family: 'Space Grotesk', -apple-system, BlinkMacSystemFont, sans-serif;
  background: var(--void);
  color: var(--text-primary);
  font-weight: 400;
  letter-spacing: 0.01em;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.font-serif {
  font-family: 'Crimson Pro', Georgia, serif;
}

.font-mono {
  font-family: 'JetBrains Mono', 'SF Mono', monospace;
  font-size: 0.9em;
  letter-spacing: -0.02em;
}

/* ============================================
   Utility Classes
   ============================================ */

.bg-grid-base { background-color: var(--void); }
.bg-grid-surface { background-color: var(--stone); }
.border-grid-line { border-color: var(--grid-visible); }
.text-text-primary { color: var(--text-primary); }
.text-text-secondary { color: var(--text-secondary); }
.text-text-muted { color: var(--text-ghost); }
.bg-accent-warm { background-color: var(--ember); }
.text-accent-warm { color: var(--ember); }

/* ============================================
   The Grid Canvas
   ============================================ */

#grid-container {
  background:
    /* Subtle noise texture */
    url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E"),
    /* Radial gradient - center warmth */
    radial-gradient(ellipse 80% 60% at 50% 50%, var(--earth) 0%, var(--abyss) 50%, var(--void) 100%);
  background-blend-mode: overlay, normal;
}

#grid-container::before {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at 50% 50%, transparent 0%, var(--void) 70%);
  pointer-events: none;
  opacity: 0.5;
}

/* ============================================
   SVG Nodes - The Topic Markers
   ============================================ */

.node {
  cursor: pointer;
  transition: all 0.4s var(--ease-out-expo);
  filter: drop-shadow(0 0 8px var(--glow-faint));
}

.node:hover {
  filter: drop-shadow(0 0 20px var(--glow-warm)) brightness(1.15);
  transform: scale(1.08);
}

.node-shape {
  transition: all 0.3s var(--ease-out-expo);
}

.node-label {
  font-family: 'Space Grotesk', sans-serif;
  font-weight: 400;
  font-size: 11px;
  letter-spacing: 0.03em;
  fill: var(--text-secondary);
  text-shadow: 0 2px 8px var(--void);
}

/* ============================================
   User Glyphs - Abstract Presence
   ============================================ */

.user-glyph {
  filter: drop-shadow(0 0 6px currentColor);
  transition: all 0.3s var(--ease-out-expo);
}

.user-glyph-self {
  filter: drop-shadow(0 0 12px var(--ember));
}

/* Dwell progress ring */
.dwell-ring {
  transition: stroke-dasharray 0.05s linear;
  filter: drop-shadow(0 0 4px var(--ember));
}

/* ============================================
   Animations
   ============================================ */

@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-4px); }
}

@keyframes pulse-glow {
  0%, 100% {
    filter: drop-shadow(0 0 8px var(--glow-soft));
    opacity: 0.9;
  }
  50% {
    filter: drop-shadow(0 0 16px var(--glow-warm));
    opacity: 1;
  }
}

@keyframes breathe {
  0%, 100% { opacity: 0.7; }
  50% { opacity: 1; }
}

@keyframes drift {
  0%, 100% { transform: translate(0, 0); }
  25% { transform: translate(2px, -2px); }
  50% { transform: translate(-1px, 1px); }
  75% { transform: translate(1px, 2px); }
}

.animate-float { animation: float 6s var(--ease-in-out-sine) infinite; }
.animate-pulse-glow { animation: pulse-glow 3s var(--ease-in-out-sine) infinite; }
.animate-breathe { animation: breathe 4s var(--ease-in-out-sine) infinite; }
.animate-breathe-fast { animation: breathe 2s var(--ease-in-out-sine) infinite; }
.animate-drift { animation: drift 20s linear infinite; }

/* Activity pulse rings - opacity only to avoid SVG transform issues */
@keyframes pulse-ring {
  0% {
    opacity: 0.4;
  }
  50% {
    opacity: 0.15;
  }
  100% {
    opacity: 0.4;
  }
}

.animate-pulse-ring {
  animation: pulse-ring 2s var(--ease-out-expo) infinite;
}

/* Slow spin for movement indicator */
@keyframes spin-slow {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

.animate-spin-slow {
  animation: spin-slow 12s linear infinite;
}

/* Floating ember particles for active nodes */
@keyframes ember-float {
  0%, 100% {
    transform: translate(0, 0);
    opacity: 0.6;
  }
  25% {
    transform: translate(3px, -5px);
    opacity: 0.8;
  }
  50% {
    transform: translate(-2px, -8px);
    opacity: 0.4;
  }
  75% {
    transform: translate(4px, -3px);
    opacity: 0.7;
  }
}

.animate-ember {
  animation: ember-float 3s ease-in-out infinite;
}

/* Activity core glow pulse - opacity only (no transform to avoid SVG origin issues) */
.activity-core {
  animation: activity-pulse 2s ease-in-out infinite;
}

@keyframes activity-pulse {
  0%, 100% {
    opacity: 0.15;
  }
  50% {
    opacity: 0.3;
  }
}

/* Stagger animations for organic feel */
.node:nth-child(odd) { animation-delay: -1s; }
.node:nth-child(3n) { animation-delay: -2s; }
.node:nth-child(5n) { animation-delay: -0.5s; }

/* ============================================
   Fluid Ripple Transition
   Like dipping into water or oil
   ============================================ */

.fluid-transition {
  position: fixed;
  inset: 0;
  z-index: 9999;
  pointer-events: none;
  overflow: hidden;
}

.fluid-ripple {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 100vmax;
  height: 100vmax;
  margin-left: -50vmax;
  margin-top: -50vmax;
  border-radius: 50%;
  transform: scale(0);
  opacity: 0;
}

.fluid-ripple-1 {
  background: radial-gradient(circle,
    transparent 0%,
    transparent 40%,
    rgba(219, 167, 111, 0.08) 50%,
    rgba(219, 167, 111, 0.15) 55%,
    rgba(219, 167, 111, 0.08) 60%,
    transparent 70%
  );
}

.fluid-ripple-2 {
  background: radial-gradient(circle,
    transparent 0%,
    transparent 35%,
    rgba(200, 180, 160, 0.06) 45%,
    rgba(200, 180, 160, 0.12) 50%,
    rgba(200, 180, 160, 0.06) 55%,
    transparent 65%
  );
}

.fluid-ripple-3 {
  background: radial-gradient(circle,
    transparent 0%,
    transparent 30%,
    rgba(245, 240, 232, 0.04) 40%,
    rgba(245, 240, 232, 0.1) 45%,
    rgba(245, 240, 232, 0.04) 50%,
    transparent 60%
  );
}

.fluid-fade {
  position: absolute;
  inset: 0;
  background: var(--void);
  opacity: 0;
}

.fluid-transition.active .fluid-ripple-1 {
  animation: ripple-out 1s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
}

.fluid-transition.active .fluid-ripple-2 {
  animation: ripple-out 1s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.1s forwards;
}

.fluid-transition.active .fluid-ripple-3 {
  animation: ripple-out 1s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.2s forwards;
}

.fluid-transition.active .fluid-fade {
  animation: fade-to-dark 1s cubic-bezier(0.4, 0, 0.2, 1) 0.3s forwards;
}

@keyframes ripple-out {
  0% {
    transform: scale(0);
    opacity: 0;
  }
  20% {
    opacity: 1;
  }
  80% {
    opacity: 1;
  }
  100% {
    transform: scale(3);
    opacity: 0;
  }
}

@keyframes fade-to-dark {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}

/* Activity-based node styling */
.node-activity-dormant {
  opacity: 0.6;
}

.node-activity-quiet {
  opacity: 0.8;
}

.node-activity-active {
  opacity: 0.95;
}

.node-activity-buzzing {
  opacity: 1;
  filter: drop-shadow(0 0 12px var(--glow-warm));
}

/* ============================================
   UI Overlays
   ============================================ */

.ui-overlay {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  color: var(--text-ghost);
}

.ui-stat {
  color: var(--text-tertiary);
  transition: color 0.3s ease;
}

.ui-stat:hover {
  color: var(--text-secondary);
}

/* ============================================
   Room Entrance Animation - Fluid/Ripple Style
   ============================================ */

.room-entrance {
  position: relative;
  opacity: 1;
}

.room-entrance.materializing {
  opacity: 1;
}

.room-entrance.materialized {
  opacity: 1;
}

/* Ripple overlay effect */
.room-ripple {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 100;
  background: radial-gradient(circle at center,
    transparent 0%,
    rgba(219, 167, 111, 0.03) 30%,
    rgba(13, 11, 10, 0.1) 60%,
    transparent 100%
  );
  animation: ripple-expand 1.2s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
}

@keyframes ripple-expand {
  0% {
    transform: scale(0);
    opacity: 1;
  }
  60% {
    opacity: 0.6;
  }
  100% {
    transform: scale(3);
    opacity: 0;
  }
}

/* Subtle vignette that stays */
.room-entrance::before {
  content: '';
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 99;
  background: radial-gradient(ellipse at center,
    transparent 0%,
    transparent 60%,
    rgba(13, 11, 10, 0.25) 100%
  );
  opacity: 1;
}

/* ============================================
   Room View Styling
   ============================================ */

.room-header {
  background: linear-gradient(to bottom, var(--stone), transparent);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
}

.room-title {
  font-family: 'Crimson Pro', serif;
  font-weight: 400;
  font-size: 1.5rem;
  color: var(--text-bright);
  letter-spacing: 0.02em;
}

.room-description {
  font-family: 'Crimson Pro', serif;
  font-weight: 300;
  font-style: italic;
  color: var(--text-tertiary);
}

/* Message bubbles */
.message-bubble {
  background: var(--bark);
  border: 1px solid var(--grid-subtle);
  border-radius: 12px;
  transition: all 0.2s ease;
}

.message-bubble:hover {
  border-color: var(--grid-visible);
  background: var(--earth);
}

.message-own {
  background: linear-gradient(135deg, rgba(219, 167, 111, 0.15), rgba(219, 167, 111, 0.08));
  border-color: rgba(219, 167, 111, 0.2);
}

.message-time {
  font-family: 'JetBrains Mono', monospace;
  font-size: 10px;
  color: var(--text-ghost);
}

/* Input area */
.chat-input {
  background: var(--stone);
  border: 1px solid var(--grid-subtle);
  border-radius: 12px;
  color: var(--text-primary);
  font-family: 'Space Grotesk', sans-serif;
  transition: all 0.3s ease;
}

.chat-input::placeholder {
  color: var(--text-ghost);
  font-style: italic;
}

.chat-input:focus {
  border-color: var(--ember-deep);
  box-shadow: 0 0 0 3px var(--glow-faint), inset 0 1px 2px rgba(0,0,0,0.2);
  outline: none;
}

.speak-button {
  background: linear-gradient(135deg, var(--ember) 0%, var(--ember-deep) 100%);
  color: var(--void);
  font-family: 'Space Grotesk', sans-serif;
  font-weight: 500;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  font-size: 12px;
  border-radius: 10px;
  transition: all 0.3s var(--ease-out-expo);
  box-shadow: 0 4px 12px var(--glow-soft);
}

.speak-button:hover {
  transform: translateY(-1px);
  box-shadow: 0 6px 20px var(--glow-warm);
}

.speak-button:active {
  transform: translateY(0);
}

/* ============================================
   Scrollbar
   ============================================ */

::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--abyss);
}

::-webkit-scrollbar-thumb {
  background: var(--bark);
  border-radius: 4px;
  border: 2px solid var(--abyss);
}

::-webkit-scrollbar-thumb:hover {
  background: var(--earth);
}

/* ============================================
   Selection & Focus
   ============================================ */

::selection {
  background: var(--ember);
  color: var(--void);
}

input:focus, textarea:focus, button:focus {
  outline: none;
}

/* ============================================
   Badge styling
   ============================================ */

.node-type-badge {
  font-family: 'JetBrains Mono', monospace;
  font-size: 10px;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  padding: 4px 10px;
  border-radius: 6px;
}

.badge-discussion { background: rgba(201, 169, 98, 0.2); color: var(--node-discussion); }
.badge-question { background: rgba(126, 184, 218, 0.2); color: var(--node-question); }
.badge-debate { background: rgba(212, 117, 106, 0.2); color: var(--node-debate); }
.badge-quiet { background: rgba(139, 154, 125, 0.2); color: var(--node-quiet); }

/* ============================================
   Responsive adjustments
   ============================================ */

@media (max-width: 768px) {
  .room-title { font-size: 1.25rem; }
  .ui-overlay { font-size: 10px; }
}
